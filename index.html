<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POTATOES TANK - RETRO WARS</title>
</head>
<body>
    <!-- SCRIPT LANGSUNG BIKIN GAME -->
    <script>
        // =========== SETUP CANVAS ===========
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        document.body.appendChild(canvas);
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        canvas.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            background: #000;
            cursor: crosshair;
        `;
        
        // =========== GAME STATE ===========
        let gameRunning = false;
        let gameStarted = false;
        
        // =========== PLAYER ===========
        const player = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            width: 60,
            height: 45,
            speed: 5,
            health: 100,
            maxHealth: 100,
            ammo: 30,
            maxAmmo: 30,
            angle: 0,
            turretAngle: 0,
            reloading: false,
            reloadTime: 0,
            invincible: 0,
            score: 0
        };
        
        // =========== GAME OBJECTS ===========
        let enemies = [];
        let bullets = [];
        let enemyBullets = [];
        let explosions = [];
        let obstacles = [];
        let keys = {};
        
        // =========== TITLE SCREEN ===========
        function showTitleScreen() {
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Title
            ctx.fillStyle = '#ff9900';
            ctx.font = 'bold 72px Courier New';
            ctx.textAlign = 'center';
            ctx.fillText('POTATOES TANK', canvas.width/2, canvas.height/2 - 100);
            
            // Subtitle
            ctx.fillStyle = '#00ff00';
            ctx.font = '28px Courier New';
            ctx.fillText('RETRO WARS 90s EDITION', canvas.width/2, canvas.height/2 - 40);
            
            // Start button
            ctx.fillStyle = '#ff6600';
            ctx.fillRect(canvas.width/2 - 150, canvas.height/2 + 20, 300, 60);
            ctx.fillStyle = '#000';
            ctx.font = 'bold 32px Courier New';
            ctx.fillText('START MISSION', canvas.width/2, canvas.height/2 + 55);
            
            // Controls
            ctx.fillStyle = '#ffcc00';
            ctx.font = '18px Courier New';
            ctx.fillText('WASD: MOVE | MOUSE: AIM | CLICK: SHOOT | R: RELOAD', canvas.width/2, canvas.height/2 + 120);
        }
        
        // =========== START GAME ===========
        function startGame() {
            if (gameStarted) return;
            
            console.log('ðŸš€ Starting Potatoes Tank...');
            gameStarted = true;
            gameRunning = true;
            
            // Reset game state
            initGame();
            
            // Start game loop
            gameLoop();
        }
        
        // =========== INIT GAME ===========
        function initGame() {
            // Reset player
            player.x = canvas.width / 2;
            player.y = canvas.height / 2;
            player.health = 100;
            player.ammo = 30;
            player.score = 0;
            
            // Clear arrays
            enemies = [];
            bullets = [];
            enemyBullets = [];
            explosions = [];
            obstacles = [];
            
            // Create enemies
            for (let i = 0; i < 5; i++) {
                spawnEnemy();
            }
            
            // Create obstacles
            for (let i = 0; i < 8; i++) {
                obstacles.push({
                    x: Math.random() * (canvas.width - 60),
                    y: Math.random() * (canvas.height - 60),
                    width: 40 + Math.random() * 40,
                    height: 40 + Math.random() * 40
                });
            }
        }
        
        // =========== SPAWN ENEMY ===========
        function spawnEnemy() {
            enemies.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                width: 50,
                height: 40,
                speed: 2 + Math.random(),
                health: 50,
                maxHealth: 50,
                angle: Math.random() * Math.PI * 2,
                shootTimer: 0,
                color: Math.random() < 0.3 ? '#ff00ff' : '#ff3333'
            });
        }
        
        // =========== DRAW FUNCTIONS ===========
        function drawPlayer() {
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Tank body (Potato)
            ctx.fillStyle = '#ff9900';
            ctx.beginPath();
            ctx.ellipse(0, 0, player.width/2, player.height/2, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Potato eyes
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(-15, -8, 5, 0, Math.PI * 2);
            ctx.arc(15, -8, 5, 0, Math.PI * 2);
            ctx.fill();
            
            // Potato smile
            ctx.beginPath();
            ctx.arc(0, 10, 10, 0.2, Math.PI - 0.2);
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            ctx.restore();
            
            // Turret
            ctx.save();
            ctx.translate(player.x, player.y);
            ctx.rotate(player.turretAngle);
            
            ctx.fillStyle = '#ff6600';
            ctx.fillRect(0, -5, 40, 10);
            
            ctx.fillStyle = '#666';
            ctx.fillRect(40, -3, 30, 6);
            
            ctx.restore();
        }
        
        function drawEnemies() {
            enemies.forEach(enemy => {
                ctx.save();
                ctx.translate(enemy.x, enemy.y);
                ctx.rotate(enemy.angle);
                
                ctx.fillStyle = enemy.color;
                ctx.beginPath();
                ctx.ellipse(0, 0, enemy.width/2, enemy.height/2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Enemy face
                ctx.fillStyle = '#000';
                ctx.fillRect(-18, -12, 12, 4);
                ctx.fillRect(6, -12, 12, 4);
                
                ctx.beginPath();
                ctx.arc(-12, -4, 4, 0, Math.PI);
                ctx.arc(12, -4, 4, 0, Math.PI);
                ctx.fill();
                
                ctx.restore();
            });
        }
        
        function drawBullets() {
            bullets.forEach(bullet => {
                ctx.fillStyle = '#00ff00';
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
            
            enemyBullets.forEach(bullet => {
                ctx.fillStyle = '#ff00ff';
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        function drawExplosions() {
            explosions.forEach(exp => {
                const size = exp.size * (exp.life / exp.maxLife);
                ctx.fillStyle = `rgba(255, 100, 0, ${exp.life / exp.maxLife})`;
                ctx.beginPath();
                ctx.arc(exp.x, exp.y, size, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        function drawObstacles() {
            obstacles.forEach(obs => {
                ctx.fillStyle = '#555';
                ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
            });
        }
        
        function drawHUD() {
            // Score
            ctx.fillStyle = '#ffcc00';
            ctx.font = '20px Courier New';
            ctx.textAlign = 'left';
            ctx.fillText(`SCORE: ${player.score}`, 20, 40);
            
            // Health
            ctx.fillStyle = '#333';
            ctx.fillRect(20, 60, 200, 25);
            ctx.fillStyle = player.health > 50 ? '#00ff00' : player.health > 25 ? '#ffff00' : '#ff0000';
            ctx.fillRect(20, 60, (player.health / player.maxHealth) * 200, 25);
            
            // Ammo
            ctx.fillStyle = '#00ccff';
            ctx.fillText(`AMMO: ${player.ammo}/${player.maxAmmo}`, 20, 110);
            
            // Enemies
            ctx.fillStyle = '#ff9900';
            ctx.fillText(`ENEMIES: ${enemies.length}`, 20, 140);
        }
        
        // =========== UPDATE FUNCTIONS ===========
        function updatePlayer() {
            // Movement
            let moveX = 0;
            let moveY = 0;
            
            if (keys['w'] || keys['ArrowUp']) moveY = -1;
            if (keys['s'] || keys['ArrowDown']) moveY = 1;
            if (keys['a'] || keys['ArrowLeft']) moveX = -1;
            if (keys['d'] || keys['ArrowRight']) moveX = 1;
            
            // Normalize diagonal
            if (moveX !== 0 && moveY !== 0) {
                moveX *= 0.707;
                moveY *= 0.707;
            }
            
            // Update position
            player.x += moveX * player.speed;
            player.y += moveY * player.speed;
            
            // Keep in bounds
            player.x = Math.max(player.width/2, Math.min(canvas.width - player.width/2, player.x));
            player.y = Math.max(player.height/2, Math.min(canvas.height - player.height/2, player.y));
            
            // Update angle
            if (moveX !== 0 || moveY !== 0) {
                player.angle = Math.atan2(moveY, moveX);
            }
            
            // Reload
            if (player.reloading) {
                player.reloadTime++;
                if (player.reloadTime >= 90) {
                    player.reloading = false;
                    player.reloadTime = 0;
                    player.ammo = player.maxAmmo;
                }
            }
            
            // Invincibility
            if (player.invincible > 0) {
                player.invincible--;
            }
        }
        
        function updateEnemies() {
            enemies.forEach((enemy, index) => {
                // Move towards player
                const dx = player.x - enemy.x;
                const dy = player.y - enemy.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                enemy.angle = Math.atan2(dy, dx);
                enemy.x += Math.cos(enemy.angle) * enemy.speed;
                enemy.y += Math.sin(enemy.angle) * enemy.speed;
                
                // Shooting
                enemy.shootTimer++;
                if (enemy.shootTimer >= 120 && distance < 400) {
                    enemyBullets.push({
                        x: enemy.x,
                        y: enemy.y,
                        angle: enemy.angle,
                        speed: 7
                    });
                    enemy.shootTimer = 0;
                }
                
                // Collision with player
                if (player.invincible === 0) {
                    const distToPlayer = Math.sqrt(
                        Math.pow(enemy.x - player.x, 2) + 
                        Math.pow(enemy.y - player.y, 2)
                    );
                    
                    if (distToPlayer < (enemy.width/2 + player.width/2)) {
                        player.health -= 10;
                        player.invincible = 30;
                        
                        if (player.health <= 0) {
                            gameOver();
                        }
                    }
                }
            });
        }
        
        function updateBullets() {
            // Player bullets
            bullets.forEach((bullet, index) => {
                bullet.x += Math.cos(bullet.angle) * bullet.speed;
                bullet.y += Math.sin(bullet.angle) * bullet.speed;
                
                // Check bounds
                if (bullet.x < 0 || bullet.x > canvas.width ||
                    bullet.y < 0 || bullet.y > canvas.height) {
                    bullets.splice(index, 1);
                    return;
                }
                
                // Check collision with enemies
                enemies.forEach((enemy, eIndex) => {
                    const dx = bullet.x - enemy.x;
                    const dy = bullet.y - enemy.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < enemy.width/2) {
                        enemy.health -= 25;
                        bullets.splice(index, 1);
                        
                        if (enemy.health <= 0) {
                            // Explosion
                            explosions.push({
                                x: enemy.x,
                                y: enemy.y,
                                size: 30,
                                life: 30,
                                maxLife: 30
                            });
                            
                            enemies.splice(eIndex, 1);
                            player.score += 100;
                            
                            // Spawn new enemy
                            spawnEnemy();
                        }
                        return;
                    }
                });
            });
            
            // Enemy bullets
            enemyBullets.forEach((bullet, index) => {
                bullet.x += Math.cos(bullet.angle) * bullet.speed;
                bullet.y += Math.sin(bullet.angle) * bullet.speed;
                
                // Check bounds
                if (bullet.x < 0 || bullet.x > canvas.width ||
                    bullet.y < 0 || bullet.y > canvas.height) {
                    enemyBullets.splice(index, 1);
                    return;
                }
                
                // Check collision with player
                if (player.invincible === 0) {
                    const dx = bullet.x - player.x;
                    const dy = bullet.y - player.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < player.width/2) {
                        player.health -= 15;
                        player.invincible = 20;
                        enemyBullets.splice(index, 1);
                        
                        if (player.health <= 0) {
                            gameOver();
                        }
                    }
                }
            });
        }
        
        function updateExplosions() {
            explosions.forEach((exp, index) => {
                exp.life--;
                if (exp.life <= 0) {
                    explosions.splice(index, 1);
                }
            });
        }
        
        // =========== GAME OVER ===========
        function gameOver() {
            gameRunning = false;
            
            // Show game over screen
            ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#ff3300';
            ctx.font = 'bold 64px Courier New';
            ctx.textAlign = 'center';
            ctx.fillText('GAME OVER', canvas.width/2, canvas.height/2 - 50);
            
            ctx.fillStyle = '#ffcc00';
            ctx.font = '32px Courier New';
            ctx.fillText(`SCORE: ${player.score}`, canvas.width/2, canvas.height/2 + 20);
            
            ctx.fillStyle = '#00ff00';
            ctx.font = '24px Courier New';
            ctx.fillText('PRESS R TO RESTART', canvas.width/2, canvas.height/2 + 80);
        }
        
        // =========== GAME LOOP ===========
        function gameLoop() {
            if (!gameRunning) {
                showTitleScreen();
                return;
            }
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Update
            updatePlayer();
            updateEnemies();
            updateBullets();
            updateExplosions();
            
            // Draw
            drawObstacles();
            drawEnemies();
            drawBullets();
            drawExplosions();
            drawPlayer();
            drawHUD();
            
            // Continue loop
            requestAnimationFrame(gameLoop);
        }
        
        // =========== EVENT LISTENERS ===========
        // Mouse click for start and shooting
        canvas.addEventListener('click', (e) => {
            if (!gameStarted) {
                // Check if clicked start button
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                if (x > canvas.width/2 - 150 && x < canvas.width/2 + 150 &&
                    y > canvas.height/2 + 20 && y < canvas.height/2 + 80) {
                    startGame();
                }
            } else if (gameRunning) {
                // Shoot
                if (player.ammo > 0 && !player.reloading) {
                    bullets.push({
                        x: player.x + Math.cos(player.turretAngle) * 40,
                        y: player.y + Math.sin(player.turretAngle) * 40,
                        angle: player.turretAngle,
                        speed: 15
                    });
                    player.ammo--;
                    
                    if (player.ammo === 0) {
                        player.reloading = true;
                    }
                }
            }
        });
        
        // Mouse move for aiming
        canvas.addEventListener('mousemove', (e) => {
            if (!gameRunning) return;
            
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            player.turretAngle = Math.atan2(mouseY - player.y, mouseX - player.x);
        });
        
        // Keyboard
        window.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            
            if (e.key === ' ') {
                // Shoot with space
                if (gameRunning && player.ammo > 0 && !player.reloading) {
                    bullets.push({
                        x: player.x + Math.cos(player.turretAngle) * 40,
                        y: player.y + Math.sin(player.turretAngle) * 40,
                        angle: player.turretAngle,
                        speed: 15
                    });
                    player.ammo--;
                    
                    if (player.ammo === 0) {
                        player.reloading = true;
                    }
                }
                e.preventDefault();
            }
            
            if (e.key === 'r' || e.key === 'R') {
                if (gameRunning && !player.reloading) {
                    player.reloading = true;
                } else if (!gameRunning) {
                    // Restart game
                    initGame();
                    gameRunning = true;
                    gameLoop();
                }
            }
            
            if (e.key === 'Escape') {
                if (gameStarted) {
                    gameStarted = false;
                    gameRunning = false;
                }
            }
        });
        
        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });
        
        // Resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
        
        // =========== START ===========
        console.log('ðŸ¥” POTATOES TANK LOADED!');
        console.log('Controls:');
        console.log('- WASD/Arrow Keys: Move');
        console.log('- Mouse: Aim');
        console.log('- Click/Space: Shoot');
        console.log('- R: Reload');
        console.log('- ESC: Main Menu');
        
        // Start with title screen
        gameLoop();
        
    </script>
</body>
</html>
